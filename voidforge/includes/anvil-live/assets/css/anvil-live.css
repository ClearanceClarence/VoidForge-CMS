/**
 * Anvil Live - Frontend Visual Editor Styles
 * VoidForge CMS v0.2.2
 */

:root {
    --al-primary: #7c3aed;
    --al-primary-hover: #6d28d9;
    --al-primary-light: #ede9fe;
    --al-bg: #ffffff;
    --al-bg-alt: #f8fafc;
    --al-border: #e2e8f0;
    --al-text: #1e293b;
    --al-text-muted: #64748b;
    --al-success: #10b981;
    --al-warning: #f59e0b;
    --al-danger: #ef4444;
    --al-topbar-h: 56px;
    --al-sidebar-w: 300px;
    --al-radius: 8px;
    --al-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
}

body.anvil-live-editing { padding-top: var(--al-topbar-h) !important; }
body.anvil-live-editing.anvil-live-sidebar-open { padding-left: var(--al-sidebar-w); }

/* Top Bar */
.anvil-live-topbar {
    position: fixed; top: 0; left: 0; right: 0; height: var(--al-topbar-h);
    background: var(--al-bg); border-bottom: 1px solid var(--al-border);
    display: flex; align-items: center; justify-content: space-between;
    padding: 0 16px; z-index: 99999; box-shadow: var(--al-shadow);
}
.anvil-live-topbar-left, .anvil-live-topbar-right { display: flex; align-items: center; gap: 8px; }
.anvil-live-topbar-center { flex: 1; max-width: 400px; margin: 0 24px; }
.anvil-live-logo { display: flex; align-items: center; gap: 8px; text-decoration: none; color: var(--al-primary); font-weight: 600; font-size: 15px; }
.anvil-live-topbar-divider { width: 1px; height: 24px; background: var(--al-border); margin: 0 8px; }
.anvil-live-topbar-btn {
    display: flex; align-items: center; justify-content: center; gap: 6px;
    padding: 8px 12px; background: transparent; border: none; border-radius: 6px;
    color: var(--al-text); font-size: 13px; font-weight: 500; cursor: pointer; transition: 0.2s;
}
.anvil-live-topbar-btn:hover { background: var(--al-bg-alt); }
.anvil-live-topbar-btn:disabled { opacity: 0.4; cursor: not-allowed; }
.anvil-live-exit-btn:hover { background: #fef2f2; color: var(--al-danger); }
.anvil-live-title-input {
    width: 100%; padding: 8px 12px; border: 1px solid var(--al-border); border-radius: 6px;
    font-size: 14px; font-weight: 500; background: var(--al-bg); transition: 0.2s;
}
.anvil-live-title-input:focus { outline: none; border-color: var(--al-primary); box-shadow: 0 0 0 3px var(--al-primary-light); }
.anvil-live-btn-primary {
    display: flex; align-items: center; gap: 6px; padding: 8px 16px;
    background: var(--al-primary); border: none; border-radius: 6px;
    color: white; font-size: 13px; font-weight: 600; cursor: pointer; transition: 0.2s;
}
.anvil-live-btn-primary:hover { background: var(--al-primary-hover); }
.anvil-live-btn { padding: 8px 16px; background: var(--al-bg); border: 1px solid var(--al-border); border-radius: 6px; color: var(--al-text); font-size: 13px; font-weight: 500; cursor: pointer; }
.anvil-live-btn:hover { background: var(--al-bg-alt); }
.anvil-live-save-status { font-size: 12px; color: var(--al-text-muted); }
.anvil-live-save-status.saving { color: var(--al-warning); }
.anvil-live-save-status.saved { color: var(--al-success); }
.anvil-live-save-status.error { color: var(--al-danger); }
.anvil-live-device-preview { display: flex; gap: 4px; }
.anvil-live-device-btn { padding: 6px 8px; background: transparent; border: none; border-radius: 4px; color: var(--al-text-muted); cursor: pointer; }
.anvil-live-device-btn:hover { background: var(--al-bg-alt); color: var(--al-text); }
.anvil-live-device-btn.active { background: var(--al-primary-light); color: var(--al-primary); }

/* Sidebar */
.anvil-live-sidebar {
    position: fixed; top: var(--al-topbar-h); left: 0; bottom: 0; width: var(--al-sidebar-w);
    background: var(--al-bg); border-right: 1px solid var(--al-border); z-index: 99998;
    display: flex; flex-direction: column; transform: translateX(-100%); transition: 0.2s;
}
body.anvil-live-sidebar-open .anvil-live-sidebar { transform: translateX(0); }
.anvil-live-sidebar-tabs { display: flex; border-bottom: 1px solid var(--al-border); }
.anvil-live-sidebar-tab {
    flex: 1; display: flex; align-items: center; justify-content: center; gap: 6px;
    padding: 12px; background: transparent; border: none; border-bottom: 2px solid transparent;
    color: var(--al-text-muted); font-size: 13px; font-weight: 500; cursor: pointer;
}
.anvil-live-sidebar-tab:hover { color: var(--al-text); background: var(--al-bg-alt); }
.anvil-live-sidebar-tab.active { color: var(--al-primary); border-bottom-color: var(--al-primary); }
.anvil-live-sidebar-panel { flex: 1; overflow-y: auto; display: none; flex-direction: column; }
.anvil-live-sidebar-panel.active { display: flex; }
.anvil-live-sidebar-search { position: relative; padding: 12px; border-bottom: 1px solid var(--al-border); }
.anvil-live-sidebar-search svg { position: absolute; left: 24px; top: 50%; transform: translateY(-50%); color: var(--al-text-muted); }
.anvil-live-sidebar-search input { width: 100%; padding: 10px 12px 10px 36px; border: 1px solid var(--al-border); border-radius: 6px; font-size: 13px; background: var(--al-bg-alt); }
.anvil-live-sidebar-search input:focus { outline: none; border-color: var(--al-primary); background: var(--al-bg); }
.anvil-live-blocks-list { flex: 1; overflow-y: auto; padding: 8px 0; }
.anvil-live-block-category { border-bottom: 1px solid var(--al-border); }
.anvil-live-block-category-header { display: flex; align-items: center; justify-content: space-between; padding: 10px 16px; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: var(--al-text-muted); cursor: pointer; }
.anvil-live-block-category-header:hover { background: var(--al-bg-alt); }
.anvil-live-block-category.collapsed .anvil-live-block-category-header svg { transform: rotate(-90deg); }
.anvil-live-block-category.collapsed .anvil-live-block-category-items { display: none; }
.anvil-live-block-category-items { padding: 4px 8px 8px; display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
.anvil-live-block-item {
    display: flex; flex-direction: column; align-items: center; gap: 6px; padding: 12px 8px;
    background: var(--al-bg-alt); border: 1px solid var(--al-border); border-radius: 6px;
    cursor: grab; text-align: center; transition: 0.2s;
}
.anvil-live-block-item:hover { border-color: var(--al-primary); background: var(--al-primary-light); }
.anvil-live-block-item-icon { width: 28px; height: 28px; color: var(--al-primary); }
.anvil-live-block-item-icon svg { width: 100%; height: 100%; }
.anvil-live-block-item-label { font-size: 11px; font-weight: 500; color: var(--al-text); }
.anvil-live-block-settings { padding: 16px; }
.anvil-live-no-selection { display: flex; flex-direction: column; align-items: center; padding: 48px 24px; text-align: center; color: var(--al-text-muted); }
.anvil-live-no-selection svg { margin-bottom: 16px; opacity: 0.4; }
.anvil-live-settings-group { margin-bottom: 16px; }
.anvil-live-settings-label { display: block; margin-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--al-text); }
.anvil-live-settings-input, .anvil-live-settings-textarea, .anvil-live-settings-select { width: 100%; padding: 8px 12px; border: 1px solid var(--al-border); border-radius: 6px; font-size: 13px; }
.anvil-live-settings-input:focus, .anvil-live-settings-textarea:focus, .anvil-live-settings-select:focus { outline: none; border-color: var(--al-primary); }
.anvil-live-settings-textarea { min-height: 80px; resize: vertical; }

/* Canvas */
.anvil-live-canvas { 
    min-height: calc(100vh - var(--al-topbar-h)); 
    padding: 24px; 
    background: var(--al-bg-alt); 
    box-sizing: border-box;
}
body.anvil-live-editing .entry-content,
body.anvil-live-editing .post-content,
body.anvil-live-editing .content-area,
body.anvil-live-editing article {
    max-width: none !important;
    width: 100% !important;
    padding: 0 !important;
    margin: 0 !important;
}
body.anvil-live-editing .single-post,
body.anvil-live-editing .page-content {
    max-width: none !important;
}
.anvil-live-blocks { 
    max-width: 1200px; 
    margin: 0 auto; 
    background: var(--al-bg); 
    border-radius: var(--al-radius); 
    box-shadow: var(--al-shadow); 
    min-height: 400px; 
    padding: 32px; 
    box-sizing: border-box;
}
body.anvil-live-device-tablet .anvil-live-blocks { max-width: 768px; }
body.anvil-live-device-mobile .anvil-live-blocks { max-width: 375px; }

/* Responsive breakpoints for content */
@media (max-width: 1024px) {
    .anvil-live-blocks { max-width: 100%; padding: 24px; }
}
@media (max-width: 768px) {
    .anvil-live-blocks { padding: 16px; }
    .anvil-columns { grid-template-columns: 1fr !important; }
}

/* Columns Block */
.anvil-live-block[data-block-type="columns"] .anvil-live-block-content {
    padding: 0;
}
.anvil-live-block[data-block-type="columns"] .anvil-live-block-content > .anvil-columns {
    margin: 0;
}
.anvil-columns {
    display: grid;
    gap: 24px;
}
.anvil-column {
    min-height: 100px;
    padding: 16px;
    background: var(--al-bg-alt);
    border: 2px dashed var(--al-border);
    border-radius: 6px;
    position: relative;
    transition: 0.2s;
    cursor: pointer;
}
.anvil-column:empty {
    display: flex;
    align-items: center;
    justify-content: center;
}
.anvil-column:empty::before {
    content: '+ Click to add blocks';
    color: var(--al-text-muted);
    font-size: 13px;
    pointer-events: none;
}
.anvil-column:hover {
    border-color: var(--al-primary);
    background: rgba(124, 58, 237, 0.05);
}

/* Column as drop target */
.anvil-column.drop-target {
    border-color: var(--al-primary);
    border-style: solid;
    background: rgba(124, 58, 237, 0.15);
    box-shadow: inset 0 0 20px rgba(124, 58, 237, 0.2);
}
.anvil-column.drop-target::after {
    content: 'Drop here';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: var(--al-primary);
    color: white;
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 600;
    pointer-events: none;
}

/* Column mode active indicator */
#anvil-live-sidebar.adding-to-column .anvil-live-sidebar-panel[data-panel="blocks"]::before {
    content: 'Click a block to add it to the selected column';
    display: block;
    padding: 12px;
    background: var(--al-primary);
    color: white;
    font-size: 12px;
    text-align: center;
    margin: -16px -16px 16px;
    border-radius: 0;
}
#anvil-live-sidebar.adding-to-column .anvil-live-block-item {
    border-color: var(--al-primary);
}
.anvil-column .anvil-live-block {
    margin-bottom: 12px;
}
.anvil-column .anvil-live-block:last-child {
    margin-bottom: 0;
}
/* Nested blocks in columns have smaller toolbars */
.anvil-column .anvil-live-block-toolbar {
    padding: 2px 6px;
    font-size: 11px;
}
.anvil-column .anvil-live-block-action {
    width: 24px;
    height: 24px;
}
.anvil-column .anvil-live-add-between {
    bottom: -8px;
}
.anvil-column .anvil-live-add-between-btn {
    width: 20px;
    height: 20px;
}

/* Rich Text Toolbar */
.anvil-live-rte-toolbar {
    position: fixed;
    display: none;
    align-items: center;
    gap: 2px;
    padding: 6px 8px;
    background: #1e293b;
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    z-index: 100001;
    transform: translateX(-50%);
}
.anvil-live-rte-toolbar.active { display: flex; }
.anvil-live-rte-toolbar::after {
    content: '';
    position: absolute;
    bottom: -6px;
    left: 50%;
    transform: translateX(-50%);
    border: 6px solid transparent;
    border-top-color: #1e293b;
    border-bottom: 0;
}
.anvil-live-rte-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    padding: 0;
    background: transparent;
    border: none;
    border-radius: 4px;
    color: #94a3b8;
    cursor: pointer;
    transition: 0.15s;
}
.anvil-live-rte-btn:hover { background: rgba(255,255,255,0.1); color: #fff; }
.anvil-live-rte-btn.active { background: var(--al-primary); color: #fff; }
.anvil-live-rte-divider { width: 1px; height: 20px; background: #475569; margin: 0 4px; }
.anvil-live-rte-select {
    padding: 4px 8px;
    background: transparent;
    border: 1px solid #475569;
    border-radius: 4px;
    color: #e2e8f0;
    font-size: 12px;
    cursor: pointer;
}
.anvil-live-rte-select:hover { border-color: #64748b; }
.anvil-live-rte-select option { background: #1e293b; }

/* Link Popup */
.anvil-live-link-popup {
    position: fixed;
    display: none;
    flex-direction: column;
    gap: 8px;
    padding: 12px;
    background: #1e293b;
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    z-index: 100002;
    min-width: 280px;
}
.anvil-live-link-popup.active { display: flex; }
.anvil-live-link-popup input {
    padding: 8px 10px;
    background: #0f172a;
    border: 1px solid #334155;
    border-radius: 4px;
    color: #e2e8f0;
    font-size: 13px;
}
.anvil-live-link-popup input:focus { outline: none; border-color: var(--al-primary); }
.anvil-live-link-popup-buttons { display: flex; gap: 8px; justify-content: flex-end; }
.anvil-live-link-popup-btn {
    padding: 6px 12px;
    background: var(--al-primary);
    border: none;
    border-radius: 4px;
    color: #fff;
    font-size: 12px;
    font-weight: 500;
    cursor: pointer;
}
.anvil-live-link-popup-btn.secondary { background: #475569; }
.anvil-live-link-popup-btn:hover { opacity: 0.9; }

/* Editable content styles */
.anvil-live-block-content[data-editable="true"] [contenteditable] {
    outline: none;
    min-height: 1em;
}
.anvil-live-block-content[data-editable="true"] [contenteditable]:empty::before {
    content: attr(data-placeholder);
    color: #94a3b8;
    pointer-events: none;
}
.anvil-live-block-content[data-editable="true"]:focus-within {
    background: rgba(124, 58, 237, 0.05);
    border-radius: 4px;
}
.anvil-live-block.editing {
    border-color: var(--al-primary) !important;
    box-shadow: 0 0 0 3px var(--al-primary-light);
}
body.anvil-live-device-tablet .anvil-live-blocks { max-width: 768px; }
body.anvil-live-device-mobile .anvil-live-blocks { max-width: 375px; }
.anvil-live-empty-state { display: flex; flex-direction: column; align-items: center; padding: 64px 32px; text-align: center; color: var(--al-text-muted); border: 2px dashed var(--al-border); border-radius: var(--al-radius); cursor: pointer; transition: 0.2s; }
.anvil-live-empty-state:hover, .anvil-live-drag-over .anvil-live-empty-state { border-color: var(--al-primary); background: var(--al-primary-light); }
.anvil-live-empty-icon { margin-bottom: 16px; opacity: 0.4; }
/* Drag and Drop */
.anvil-live-drag-over .anvil-live-blocks { 
    outline: 2px dashed var(--al-primary); 
    outline-offset: -2px; 
}
.anvil-live-block-item.dragging { opacity: 0.5; }
.anvil-live-block.dragging { 
    opacity: 0.4; 
    transform: scale(0.98);
}

/* Drop Indicator Line */
.anvil-live-drop-indicator {
    position: absolute;
    left: 0;
    right: 0;
    height: 4px;
    background: var(--al-primary);
    border-radius: 2px;
    pointer-events: none;
    z-index: 1000;
    box-shadow: 0 0 8px var(--al-primary);
    display: none;
}
.anvil-live-drop-indicator.active {
    display: block;
}
.anvil-live-drop-indicator::before,
.anvil-live-drop-indicator::after {
    content: '';
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 12px;
    height: 12px;
    background: var(--al-primary);
    border-radius: 50%;
}
.anvil-live-drop-indicator::before { left: -6px; }
.anvil-live-drop-indicator::after { right: -6px; }

/* Drop zone highlights */
.anvil-live-block.drop-above::before {
    content: '';
    position: absolute;
    top: -10px;
    left: 0;
    right: 0;
    height: 4px;
    background: var(--al-primary);
    border-radius: 2px;
    box-shadow: 0 0 8px var(--al-primary);
}
.anvil-live-block.drop-below::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 0;
    right: 0;
    height: 4px;
    background: var(--al-primary);
    border-radius: 2px;
    box-shadow: 0 0 8px var(--al-primary);
}

/* Drag ghost/preview */
.anvil-live-drag-ghost {
    position: fixed;
    padding: 12px 16px;
    background: var(--al-primary);
    color: white;
    border-radius: 8px;
    font-size: 13px;
    font-weight: 500;
    box-shadow: 0 8px 24px rgba(124, 58, 237, 0.4);
    pointer-events: none;
    z-index: 100003;
    display: flex;
    align-items: center;
    gap: 8px;
    transform: translate(-50%, -50%);
}
.anvil-live-drag-ghost svg {
    width: 18px;
    height: 18px;
}

/* Empty state drop target */
.anvil-live-empty-state.drop-target {
    border-color: var(--al-primary);
    background: var(--al-primary-light);
}

/* Sortable styles */
.sortable-ghost { 
    opacity: 0.4; 
    background: var(--al-primary-light);
}
.sortable-chosen {
    box-shadow: 0 8px 24px rgba(0,0,0,0.15);
}
.sortable-drag {
    opacity: 1 !important;
    background: white;
    box-shadow: 0 12px 32px rgba(0,0,0,0.2);
}

/* Blocks */
.anvil-live-block { position: relative; margin-bottom: 16px; border: 2px solid transparent; border-radius: 6px; transition: 0.2s; }
.anvil-live-block:hover { border-color: var(--al-border); }
.anvil-live-block.selected { border-color: var(--al-primary); }
.anvil-live-block-toolbar {
    position: absolute; top: -36px; left: 0; right: 0; display: flex; align-items: center; justify-content: space-between;
    padding: 4px 8px; background: var(--al-text); border-radius: 6px; opacity: 0; visibility: hidden; transform: translateY(4px); transition: 0.2s; z-index: 10;
}
.anvil-live-block:hover .anvil-live-block-toolbar, .anvil-live-block.selected .anvil-live-block-toolbar { opacity: 1; visibility: visible; transform: translateY(0); }
.anvil-live-block-toolbar-left, .anvil-live-block-toolbar-right { display: flex; align-items: center; gap: 4px; }
.anvil-live-block-handle { display: flex; padding: 4px; color: rgba(255,255,255,0.6); cursor: grab; }
.anvil-live-block-type { font-size: 11px; font-weight: 500; color: rgba(255,255,255,0.8); margin-left: 4px; }
.anvil-live-block-action { display: flex; align-items: center; justify-content: center; width: 28px; height: 28px; background: transparent; border: none; border-radius: 4px; color: rgba(255,255,255,0.8); cursor: pointer; }
.anvil-live-block-action:hover { background: rgba(255,255,255,0.1); color: white; }
.anvil-live-block-action-delete:hover { background: var(--al-danger); }
.anvil-live-block-content { padding: 8px; min-height: 40px; }
.anvil-live-block-content[data-editable="true"] [contenteditable] { outline: none; }
.anvil-live-block-content[data-editable="true"]:focus-within { background: var(--al-primary-light); border-radius: 4px; }
.anvil-live-add-between { position: absolute; bottom: -12px; left: 50%; transform: translateX(-50%); opacity: 0; transition: 0.2s; z-index: 5; }
.anvil-live-block:hover .anvil-live-add-between { opacity: 1; }
.anvil-live-add-between-btn { display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; background: var(--al-primary); border: none; border-radius: 50%; color: white; cursor: pointer; }
.anvil-live-add-between-btn:hover { background: var(--al-primary-hover); transform: scale(1.1); }
.sortable-ghost { opacity: 0.4; }

/* Modals */
.anvil-live-modal { position: fixed; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.5); z-index: 100000; opacity: 0; visibility: hidden; transition: 0.2s; }
.anvil-live-modal.active { opacity: 1; visibility: visible; }
.anvil-live-modal-content { width: 90%; max-width: 560px; max-height: 90vh; background: var(--al-bg); border-radius: var(--al-radius); display: flex; flex-direction: column; transform: scale(0.95); transition: 0.2s; }
.anvil-live-modal.active .anvil-live-modal-content { transform: scale(1); }
.anvil-live-modal-small { max-width: 400px; }
.anvil-live-modal-header { display: flex; align-items: center; justify-content: space-between; padding: 16px 20px; border-bottom: 1px solid var(--al-border); }
.anvil-live-modal-header h3 { margin: 0; font-size: 16px; font-weight: 600; }
.anvil-live-modal-close { display: flex; width: 32px; height: 32px; background: transparent; border: none; border-radius: 6px; color: var(--al-text-muted); cursor: pointer; align-items: center; justify-content: center; }
.anvil-live-modal-close:hover { background: var(--al-bg-alt); }
.anvil-live-modal-body { flex: 1; overflow-y: auto; padding: 20px; }
.anvil-live-modal-footer { display: flex; justify-content: flex-end; gap: 12px; padding: 16px 20px; border-top: 1px solid var(--al-border); }

@media (max-width: 768px) {
    .anvil-live-sidebar { width: 100%; }
    body.anvil-live-sidebar-open { padding-left: 0; }
    body.anvil-live-sidebar-open .anvil-live-canvas { margin-left: 0; }
    .anvil-live-topbar-center { display: none; }
    .anvil-live-device-preview { display: none; }
}
